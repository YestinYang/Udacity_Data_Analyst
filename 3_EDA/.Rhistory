p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
print('Summary of alcohol attribute')
table(rw[rw$citric.acid==0,"citric.acid"])
ggplot(aes(x = alcohol), data = rw) +
geom_histogram(binwidth = 0.2)
print('Summary of alcohol attribute')
summary(rw$alcohol)
print('Maximum of alcohol')
max(rw$alcohol)
duplicated(rw)
table(duplicated(rw))
# Chunk 1
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
# Chunk 2
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw)]
# Chunk 3
dim(rw)
str(rw)
summary(rw)
rw$quality <- as.factor(rw$quality)
ggplot(aes(x = quality), data = rw) +
geom_histogram(stat="count")
# Chunk 4
library(gridExtra)
p1 = ggplot(aes(x = fixed.acidity), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = volatile.acidity), data = rw) +
geom_histogram(binwidth = 0.02)
p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
print('Counts of wines with zero citric acid')
table(rw[rw$citric.acid==0,"citric.acid"])
# Chunk 5
p1 = ggplot(aes(x = residual.sugar), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = chlorides), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,ncol=1)
# Chunk 6
p1 = ggplot(aes(x = residual.sugar), data = rw) +
geom_histogram(binwidth = 0.05) +
xlim(c(0,4))
p2 = ggplot(aes(x = chlorides), data = rw) +
geom_histogram(binwidth = 0.001) +
xlim(c(0,0.15))
grid.arrange(p1,p2,ncol=1)
print('Value counts of sugar attribute')
table(rw$residual.sugar)
# Chunk 7
p1 = ggplot(aes(x = free.sulfur.dioxide), data = rw) +
geom_histogram(binwidth = 1)
p2 = ggplot(aes(x = total.sulfur.dioxide), data = rw) +
geom_histogram(binwidth = 3)
p3 = ggplot(aes(x = sulphates), data = rw) +
geom_histogram(binwidth = 0.02)
grid.arrange(p1,p2,p3,ncol=1)
# Chunk 8
ggplot(aes(x = density), data = rw) +
geom_histogram(binwidth = 0.0005)
# Chunk 9
ggplot(aes(x = pH), data = rw) +
geom_histogram(binwidth = 0.02)
# Chunk 10
ggplot(aes(x = alcohol), data = rw) +
geom_histogram(binwidth = 0.2)
print('Summary of alcohol attribute')
summary(rw$alcohol)
print('Maximum of alcohol')
max(rw$alcohol)
# Chunk 11
# Chunk 12
# Chunk 13
# Chunk 14
# Chunk 15
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
dim(rw)
str(rw)
summary(rw)
rw$quality <- as.factor(rw$quality)
ggplot(aes(x = quality), data = rw) +
geom_histogram(stat="count")
library(gridExtra)
p1 = ggplot(aes(x = fixed.acidity), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = volatile.acidity), data = rw) +
geom_histogram(binwidth = 0.02)
p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
print('Counts of wines with zero citric acid')
table(rw[rw$citric.acid==0,"citric.acid"])
library(gridExtra)
p1 = ggplot(aes(x = fixed.acidity), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = volatile.acidity), data = rw) +
geom_histogram(binwidth = 0.02)
p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
# 加载数据
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
rw <- read.csv('../project/wineQualityReds.csv', sep = ',')
rw <- read.csv('./project/wineQualityReds.csv', sep = ',')
# 加载数据
rw <- read.csv('./project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
# 加载数据
rw <- read.csv('./project/wineQualityReds.csv', sep = ',')
rw <- rw[-1]  # remove index column
print('Counts of duplicated records')
table(duplicated(rw))
rw <- rw[!duplicated(rw),]
dim(rw)
str(rw)
summary(rw)
rw$quality <- as.factor(rw$quality)
ggplot(aes(x = quality), data = rw) +
geom_histogram(stat="count")
library(gridExtra)
p1 = ggplot(aes(x = fixed.acidity), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = volatile.acidity), data = rw) +
geom_histogram(binwidth = 0.02)
p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
print('Counts of wines with zero citric acid')
table(rw[rw$citric.acid==0,"citric.acid"])
p1 = ggplot(aes(x = residual.sugar), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = chlorides), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,ncol=1)
p1 = ggplot(aes(x = residual.sugar), data = rw) +
geom_histogram(binwidth = 0.05) +
xlim(c(0,4))
p2 = ggplot(aes(x = chlorides), data = rw) +
geom_histogram(binwidth = 0.001) +
xlim(c(0,0.15))
grid.arrange(p1,p2,ncol=1)
print('Value counts of sugar attribute')
table(rw$residual.sugar)
library(gridExtra)
p1 = ggplot(aes(x = fixed.acidity), data = rw) +
geom_histogram(binwidth = 0.2)
p2 = ggplot(aes(x = volatile.acidity), data = rw) +
geom_histogram(binwidth = 0.02)
p3 = ggplot(aes(x = citric.acid), data = rw) +
geom_histogram(binwidth = 0.01)
grid.arrange(p1,p2,p3,ncol=1)
print('Counts of wines with zero citric acid')
table(rw[rw$citric.acid==0,"citric.acid"])
p1 = ggplot(aes(x = residual.sugar), data = rw) +
geom_histogram(binwidth = 0.05) +
xlim(c(0,4))
p2 = ggplot(aes(x = chlorides), data = rw) +
geom_histogram(binwidth = 0.001) +
xlim(c(0,0.15))
grid.arrange(p1,p2,ncol=1)
print('Value counts of sugar attribute')
table(rw$residual.sugar)
p1 = ggplot(aes(x = free.sulfur.dioxide), data = rw) +
geom_histogram(binwidth = 1)
p2 = ggplot(aes(x = total.sulfur.dioxide), data = rw) +
geom_histogram(binwidth = 3)
p3 = ggplot(aes(x = sulphates), data = rw) +
geom_histogram(binwidth = 0.02)
grid.arrange(p1,p2,p3,ncol=1)
ggplot(aes(x = density), data = rw) +
geom_histogram(binwidth = 0.0005)
ggplot(aes(x = pH), data = rw) +
geom_histogram(binwidth = 0.02)
ggplot(aes(x = alcohol), data = rw) +
geom_histogram(binwidth = 0.2)
print('Summary of alcohol attribute')
summary(rw$alcohol)
print('Maximum of alcohol')
max(rw$alcohol)
ggplot(aes(x = pH), data = rw) +
geom_histogram(binwidth = 0.02)
print('Summary of pH attribute')
summary(rw$pH)
library("GGally", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
library(GGally)
ggpairs(rw)
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gridExtra)
library(GGally)
ggpairs(rw)
summary(rw)
ggplot(aes(x = free.sulfur.dioxide, y=total.sulfur.dioxide), data = rw) +
geom_point()
ggplot(aes(x = free.sulfur.dioxide, y=total.sulfur.dioxide), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
lm.sulfur <- lm(free.sulfur.dioxide~total.sulfur.dioxide)
lm.sulfur <- lm(rw$total.sulfur.dioxide~rw$free.sulfur.dioxide)
lm.sulfur
lm.sulfur <- lm(rw$total.sulfur.dioxide~rw$free.sulfur.dioxide)
summary(lm.sulfur)
ggpairs(rw)
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gridExtra)
library(GGally)
ggpairs(rw)
ggplot(aes(x = alcohol, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
ggplot(aes(x = residual.sugar, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
ggplot(aes(x = fixed.acidity, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
print('Linear model of fixed.acidity and density, with corresponding significance test')
lm.sulfur <- lm(rw$density~rw$fixed.acidity)
summary(lm.sulfur)
ggplot(aes(x = alcohol, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
print('Linear model of fixed.acidity and density, with corresponding significance test')
lm.alch.density <- lm(rw$density~rw$alcohol)
summary(lm.alch.density)
ggplot(aes(x = alcohol, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'auto', color = 'red')
ggplot(aes(x = alcohol, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'glm', color = 'red')
print('Linear model of alcohol and density, with corresponding significance test')
lm.alch.density <- lm(rw$density~rw$alcohol)
summary(lm.alch.density)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(notch = TRUE) +
geom_jitter()
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gridExtra)
library(GGally)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(notch = TRUE) +
geom_jitter()
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot() +
geom_jitter()
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot()
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(notch = TRUE)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(notch = TRUE)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(varwidth = TRUE, notch = TRUE)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot(notch = TRUE)
ggplot(aes(x = quality, y=volatile.acidity), data = rw) +
geom_boxplot()
aov(volatile.acidity~quality, data = rw)
summary(aov(volatile.acidity~quality, data = rw))
summary(aov(volatile.acidity ~ quality, data = rw))
library(gplots)
plotmeans(volatile.acidity ~ quality)
install.packages("gplots")
install.packages("ggpubr")
summary(volatile.quality.ANOVA <- aov(volatile.acidity ~ quality, data = rw))
TukeyHSD(volatile.quality.ANOVA, "quality", ordered = TRUE)
plot(TukeyHSD(volatile.quality.ANOVA, "quality"))
summary(volatile.quality.ANOVA <- aov(volatile.acidity ~ quality, data = rw))
TukeyHSD(volatile.quality.ANOVA, "volatile.acidity", ordered = TRUE)
plot(TukeyHSD(volatile.quality.ANOVA, "volatile.acidity"))
summary(volatile.quality.ANOVA <- aov(volatile.acidity ~ quality, data = rw))
TukeyHSD(volatile.quality.ANOVA, "volatile.acidity", ordered = TRUE)
summary(volatile.quality.ANOVA <- aov(volatile.acidity ~ quality, data = rw))
TukeyHSD(volatile.quality.ANOVA, "volatile\.acidity", ordered = TRUE)
plot(TukeyHSD(volatile.quality.ANOVA, "volatile.acidity"))
summary(volatile.quality.ANOVA <- aov(volatile.acidity ~ quality, data = rw))
TukeyHSD(volatile.quality.ANOVA, ordered = TRUE)
plot(TukeyHSD(volatile.quality.ANOVA))
summary(rw
)
install.packages("~/Downloads/gplots_3.0.1.tgz", repos = NULL, type = .Platform$pkgType)
library("gplots", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gplots)
library(gridExtra)
library(GGally)
install.packages("gplots")
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gplots)
library(gridExtra)
library(GGally)
summary(aov(volatile.acidity ~ quality, data = rw))
plotmeans(volatile.acidity ~ quality, data = rw)
ci.mean(rw$volatile.acidity)
warinings
warinings()
warnings()
ci(rw$volatile.acidity, confidence=0.95, alpha=1 - confidence)
install.packages("gmodels")
library("gmodels", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
ci(rw$volatile.acidity, confidence=0.95, alpha=1 - confidence)
ci(rw$volatile.acidity)
print('ANOVA for volatile.acidity and quality')
summary(aov(volatile.acidity ~ quality, data = rw))
plotmeans(volatile.acidity ~ quality, data = rw)
print('ANOVA for volatile.acidity and quality')
summary(aov(volatile.acidity ~ quality, data = rw))
plotmeans(volatile.acidity ~ quality, data = rw, main = "Mean Plot with 95% CI")
sd(rw[quality==5,volatile.acidity])
sd(rw[quality==5,'volatile.acidity'])
sd(rw[rw$quality==5,'volatile.acidity'])
sd(rw[rw$quality==4,'volatile.acidity'])
sd(rw[rw$quality==3,'volatile.acidity'])
sd(rw[rw$quality==6,'volatile.acidity'])
sd(rw[rw$quality==7,'volatile.acidity'])
sd(rw[rw$quality==8,'volatile.acidity'])
ggplot(aes(x = quality, y=citric.acid), data = rw) +
geom_boxplot()
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gplots)
library(gridExtra)
library(GGally)
ggplot(aes(x = quality, y=citric.acid), data = rw) +
geom_boxplot()
print('ANOVA for citric.acid and quality')
summary(aov(citric.acid ~ quality, data = rw))
plotmeans(citric.acid ~ quality, data = rw, main = "Mean Plot with 95% CI")
print('ANOVA for citric.acid and quality')
summary(aov(citric.acid ~ quality, data = rw))
plotmeans(citric.acid ~ quality, data = rw, main = "Mean Plot with 95% CI")
ggplot(aes(x = quality, y=sulphates), data = rw) +
geom_boxplot()
print('ANOVA for sulphates and quality, and 95% CI plot')
summary(aov(sulphates ~ quality, data = rw))
plotmeans(sulphates ~ quality, data = rw, main = "Mean Plot with 95% CI")
ggplot(aes(x = quality, y=alcohol), data = rw) +
geom_boxplot()
print('ANOVA for sulphates and quality, and 95% CI plot')
summary(aov(alcohol ~ quality, data = rw))
plotmeans(alcohol ~ quality, data = rw, main = "Mean Plot with 95% CI")
print('Linear model of fixed.acidity and density, with corresponding significance test')
lm.acid.density <- lm(rw$density~rw$fixed.acidity)
summary(lm.acid.density)
print('Linear model of alcohol and density, with corresponding significance test')
lm.alch.density <- lm(rw$density~rw$alcohol)
summary(lm.alch.density)
ggplot(aes(x = alcohol, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'glm', color = 'red')
ggplot(aes(x = fixed.acidity, y=density), data = rw) +
geom_point() +
geom_smooth(method = 'lm', color = 'red')
print('Linear model of fixed.acidity and pH, with corresponding significance test')
lm.acid.ph <- lm(rw$pH~rw$fixed.acidity)
summary(lm.acid.ph)
ggplot(aes(x = fixed.acidity, y=pH), data = rw) +
geom_point() +
geom_smooth(method = 'glm', color = 'red')
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gplots)
library(gridExtra)
library(GGally)
ggpairs(rw)
install.packages("randomForest")
library("randomForest", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
detach("package:randomForest", unload=TRUE)
library("randomForest", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
set.seed(8888)
RFmodel = randomForest(quality ~ ., data = rw, importance = True, ntree=300)
plot(RFmodel)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = True, ntree=300)
plot(RFmodel)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=300)
plot(RFmodel)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=150)
plot(RFmodel)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=150)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=300)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=3000)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=500)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=250)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, proximity = TRUE, ntree=300)
RFmodel
library("nnet", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
set.seed(8888)
multi.norm.model <- multinom(quality ~ ., data = rw)
multi.norm.model
set.seed(8888)
multi.norm.model <- multinom(quality ~ ., data = rw)
summary(multi.norm.model)
detach("package:nnet", unload=TRUE)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, proximity = TRUE, ntree=300)
RFmodel
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, proximity = TRUE, ntree=300)
RFmodel
importance(RFmodel,type=1)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=300)
RFmodel
importance(RFmodel,type=1)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=300)
RFmodel
importance(RFmodel,type=1)
importance(RFmodel,type=2)
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gplots)
library(gridExtra)
library(GGally)
library(randomForest)
set.seed(8888)
RFmodel <- randomForest(quality ~ ., data = rw, importance = TRUE, ntree=300)
RFmodel
importance(RFmodel,type=1)
table(rw$quality)
(577+535)/1359
ggpairs(rw)
View(rw)
